{"title":"模型格式和材質","uid":"9969c9a42c025437ce5d231d56edb863","slug":"GraphicQuest/GQ002 模型格式和材質","date":"2022-12-14T14:00:28.000Z","updated":"2022-12-14T14:57:29.305Z","comments":true,"path":"api/articles/GraphicQuest/GQ002 模型格式和材質.json","keywords":null,"cover":"https://cdn.discordapp.com/attachments/1032335453988335676/1041569155167567872/IMG_20221114_114537.jpg","content":"<h1 id=\"GQ002-模型格式和材質\"><a href=\"#GQ002-模型格式和材質\" class=\"headerlink\" title=\"GQ002 模型格式和材質\"></a>GQ002 模型格式和材質</h1><h1 id=\"OBJ文件\"><a href=\"#OBJ文件\" class=\"headerlink\" title=\"OBJ文件\"></a>OBJ文件</h1><p>OBJ文件是一種被廣泛使用的3D模型文件格式（obj為後綴名）。由Alias|Wavefront公司為3D建模和動畫軟件”Advanced Visualizer”開發的一種標準，適合用於3D軟件模型之間的互導，也可以通過3dsmax、Maya等建模軟件讀寫。</p>\n<p>重點:</p>\n<ul>\n<li>v（vertex）数据段: 模型顶点列表</li>\n<li>vt（vertex texture）数据段：模型顶点的纹理坐标列表</li>\n<li>vn（vertex normal）数据段：顶点法线列表</li>\n<li>f（face）：模型的三角面列表</li>\n<li>紋理座標 (UV座標)</li>\n</ul>\n<h2 id=\"OBJ文件格式\"><a href=\"#OBJ文件格式\" class=\"headerlink\" title=\"OBJ文件格式:\"></a>OBJ文件格式:</h2><pre class=\"line-numbers language-obj\" data-language=\"obj\"><code class=\"language-obj\"># &quot;#&quot;号开头是注释行\n# v（vertex）数据段: 模型顶点列表\n# 顶点位置信息，是xyz三维坐标\n# v开头的每一行描述一个顶点，行数等于顶点数。8个顶点所以有8行\nv  1.00  -1.00  -1.00\nv  1.00  1.00  1.00\n......\n# vt（vertex texture）数据段：模型顶点的纹理坐标列表\n# 顶点的纹理坐标信息，是xy二维坐标\n# vt开头的每一行描述一个纹理坐标，行数大于等于顶点数，因为一个模型顶点在贴图的UV坐标系中很可能对应多个顶点&#x2F;纹理坐标。且坐标值范围是在0~1之间，这个模型中有14行。\n# 关于纹理坐标，本文不多解释纹理坐标，就是UV座標\nvt  0.74  0.75\nvt  0.29  0.55\n......\n# vn（vertex normal）数据段：顶点法线列表\n# 三维法向量，xyz\n# vn开头的每一行描述一个法向量，行数大于等于顶点数。 前面介绍了，法线是与面相关的概念，但是现在的面是靠顶点来描述，拿点&quot;1&quot;为例，它与参与构成了三个面，所以&quot;顶点1&quot;对应有3条法线\n# 可能你已经发现了，在这个立方体模型中，共面顶点的法向量的方向是相同的，也就是说这里面的数据会重复，所以在建模软件导出obj文件时有个优化的选项，勾选后的导出的法线列表数据中就不会有重复项，这里的例子优化后有6条法线*\nvn  -1.00 0.00 0.00 \nvn  1.00 0.00 0.00\nvn  0.00 1.00 0.00\n......\n# f（face）：模型的三角面列表\n# f开头的每一行描述一个面 ，关键的来了，三个点组成一个面，怎样拿到这三个点呢？通过从1开始的索引，去前面的v、vt、vn列表中去取。\n# 总结一下就是：每一行定义1个面，1个面包含3个点，1个点具有“顶点&#x2F;纹理坐标&#x2F;法线”3个索引值，索引的是前面3个列表的信息。\nf  1&#x2F;1&#x2F;1  2&#x2F;2&#x2F;1  3&#x2F;3&#x2F;1      # 顶点1、顶点2、顶点3 组成的面\nf  2&#x2F;2&#x2F;1  3&#x2F;3&#x2F;1  4&#x2F;4&#x2F;1      # 顶点2、顶点3、顶点4 组成的面\nf  1&#x2F;1&#x2F;1  5&#x2F;10&#x2F;1  8&#x2F;14&#x2F;6  # 顶点1、顶点5、顶点8 组成的面\n......</code></pre>\n<p>以上便是obj 文件的核心部分，此外還有一些數據段，記錄如下。</p>\n<ul>\n<li>o 對象名</li>\n<li>g 組名</li>\n<li>s 平滑組</li>\n<li>usemtl 材質名</li>\n<li>mtllib 材質庫.mtl</li>\n</ul>\n<p>由於Obj文件和mtl文件是息息相關的，這裡留下mtl文件格式供你自行研究</p>\n<ul>\n<li><a href=\"https://www.loc.gov/preservation/digital/formats/fdd/fdd000508.shtml\">更加詳細mtl文件格式</a></li>\n</ul>\n<p>在model&#x2F;文件下存放著一些obj格式文件(<del>找了很久卻網上沒有的模型</del>)，你也可以參考一下!</p>\n<h1 id=\"FBX格式\"><a href=\"#FBX格式\" class=\"headerlink\" title=\"FBX格式\"></a>FBX格式</h1><p>和OBJ格式差不多，可以儲存更多類型的信息，是更加通用的文件格式，比如:</p>\n<ul>\n<li>動畫</li>\n<li>材質特性</li>\n<li>貼圖</li>\n<li>骨骼動畫</li>\n<li>燈光</li>\n<li>攝像機</li>\n<li>頂點顏色</li>\n<li>等等…</li>\n</ul>\n<h1 id=\"提高內容\"><a href=\"#提高內容\" class=\"headerlink\" title=\"提高內容:\"></a>提高內容:</h1><ol>\n<li>材質 反射光 光滑組<details></li>\n</ol>\n<h1 id=\"材質\"><a href=\"#材質\" class=\"headerlink\" title=\"材質\"></a>材質</h1><p>在現實世界中不存在完美的表面，一個模型能攜帶的法線也有限。因此可以使用漫反射，高光，折射等計算去調整法線，也就能影響光照計算的結果</p>\n<h1 id=\"反射光\"><a href=\"#反射光\" class=\"headerlink\" title=\"反射光\"></a>反射光</h1><p>在現實世界中，每個物體都會對光產生不同的反應，例如:</p>\n<ul>\n<li>有些物體反射光的時候不會產生太多的散射(Scatter)，而是產生一個較小的高光點</li>\n<li>有些物體則散射較多，產生一個更大半徑的高光點</li>\n</ul>\n<h1 id=\"反射光類型\"><a href=\"#反射光類型\" class=\"headerlink\" title=\"反射光類型\"></a>反射光類型</h1><ul>\n<li>漫反射: 將入射光線均勻地反射出去 (Lambertian 模型)</li>\n<li>鏡面反射: 將入射光線根據表面法線進行反射，且只有在反射方向有能量，其他方向能量則為0</li>\n<li>折射: 根據折射率折射一部分光線進入物體之中</li>\n<li>粗糙鏡面反射: 光線偏移較小，反射集中於一個區域內</li>\n<li>粗糙鏡面折射: 光線偏移較小，反射和折射集中於一個區域內</li>\n<li>多層材質: 多個物體反射(表面一層)出來的投影</li>\n<li>次表面散射: 在半透明的物體內多次反射，多出現於半透明的物體 (玉石，牛奶，皮膚(通常有三層))</li>\n</ul>\n<h1 id=\"頂點顏色小技巧\"><a href=\"#頂點顏色小技巧\" class=\"headerlink\" title=\"頂點顏色小技巧\"></a>頂點顏色小技巧</h1><ul>\n<li>最常用的：作為一種存儲的mask使用（這樣可以少使用一張圖）</li>\n</ul>\n<ol>\n<li>不想讓臉上有菲涅爾效應，就把臉塗黑，乘上頂點色</li>\n<li>不想讓某些地方有描邊，可以如法炮製</li>\n<li>想把其它信息塞入頂點色。</li>\n</ol>\n<ul>\n<li>可用於預先指定照明、阻光和其他視覺效果。</li>\n<li>把顏色信息存在頂點裡，但在低模的情況下效果很差。<br>(塞入頂點色的信息必須是線性變化的，如果不是，就要做好精度打折的準備)</li>\n</ul>\n<ul>\n<li><a href=\"https://www.ddove.com/edu/chapter/8123.html\">3ds Max 顶点颜色</a></li>\n</ul>\n<p>3ds Max 中的所有對像都具有貼圖通道，其中保存關於紋理貼圖以及頂點顏色、照明和 Alpha 的信息。網格對象同樣具有幾何體和頂點選擇通道。</p>\n<blockquote><span class=\"custom-blockquote-svg\"><svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"\" xmlns=\"http://www.w3.org/2000/svg\" data-reactroot=\"\">\n<path fill=\"\" d=\"M22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22C13.8 22 15.5 21.5 17 20.6L22 22L20.7 17C21.5 15.5 22 13.8 22 12Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\" undefined=\"1\"></path>\n<path fill=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\" undefined=\"1\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M17 8.5C15.23 8.97 14.07 10.84 14.01 13.27C14 13.33 14 13.4 14 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M9 8.5C7.23 8.97 6.07 10.84 6.01 13.27C6 13.33 6 13.4 6 13.47V13.5\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M15.97 11.5H16.04C17.12 11.5 18 12.38 18 13.47V13.53C18 14.62 17.12 15.5 16.03 15.5H15.96C14.88 15.5 14 14.62 14 13.53V13.46C14 12.38 14.88 11.5 15.97 11.5Z\"></path>\n<path stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\" stroke=\"\" d=\"M7.97 11.5H8.04C9.12 11.5 10 12.38 10 13.47V13.53C10 14.62 9.12 15.5 8.03 15.5H7.97C6.88 15.5 6 14.62 6 13.53V13.46C6 12.38 6.88 11.5 7.97 11.5Z\"></path>\n</svg>\n</span><p>主通道為頂點顏色，這可以使對像中的每個頂點都有其自己的顏色，並且在頂點之間自動漸變。此著色默認情況下不可見，但您可以通過“對象屬性”設置切換其顯示。還可以通過“頂點繪製”修改器等各種功能查看和編輯頂點著色。它可用於預先指定照明、阻光和其他視覺效果。貼圖通道數據也可由如游戲引擎等外部應用程序使用</p></blockquote>\n<h1 id=\"光滑組\"><a href=\"#光滑組\" class=\"headerlink\" title=\"光滑組\"></a>光滑組</h1><p>光滑組（smoothing group）是用來設置邊緣線的光滑顯示的。</p>\n<p>smoothing group定義了模型邊緣被渲染出來的方式，下圖三個瓶子是同一個模型。左邊的瓶子是硬邊渲染出來的。右邊的瓶子就是光滑的邊緣渲染出來的。中間的瓶子在高光區域設置了smoothing group，所以高光區是平滑的，而其他邊緣仍然是硬邊渲染</p>\n<p><img src=\"/project/pic/%E8%9E%A2%E5%B9%95%E6%93%B7%E5%8F%96%E7%95%AB%E9%9D%A2%202022-08-28%20212131.png\"></p>\n<p>下面圖標出了面的亮度(不是確切數字)，兩面之間的過渡就是兩面亮度和的平均值，光滑組處理面之間的光照信息，提高它們的亮度、飽和度</p>\n<p><img src=\"/project/pic/%E8%9E%A2%E5%B9%95%E6%93%B7%E5%8F%96%E7%95%AB%E9%9D%A2%202022-08-28%20212355.png\"></p>\n<ul>\n<li>如果兩個面一個光滑組是1，另一個是2，就不進行計算</li>\n<li>如果他們的光滑組都是1，就會進行光照計算，產生光滑效果，影響最終渲染</li>\n</ul>\n<p><img src=\"/project/pic/%E8%9E%A2%E5%B9%95%E6%93%B7%E5%8F%96%E7%95%AB%E9%9D%A2%202022-08-28%20212524.png\"></p>\n<h1 id=\"光滑組和法線\"><a href=\"#光滑組和法線\" class=\"headerlink\" title=\"光滑組和法線\"></a>光滑組和法線</h1><p>使用Substance Painter軟件製作漸變色的法線貼圖的時候，會出現黑邊情況</p>\n<ul>\n<li>光滑組相連的模型，法線貼圖都存在大漸變色，導致模型的法線效果會很奇怪（平面上有發暗發亮的光影）。當你發現你的模型出現這種漸變時，一定是出現了光滑組的問題。</li>\n<li>中間的兩個模型出現了不同程度的接縫（第三個模型的接縫非常明顯，第二個模型則弱一些）。光滑組和uv統一相連或斷開，是不會出現明顯接縫的，當遇到接縫問題，優先考慮模型的光滑組和uv是否統一</li>\n</ul>\n<p><img src=\"/project/pic/v2-5705f6817b9befd91fdb70f13f352fa7_720w.jpg\" alt=\"光滑組和法線\"></p>\n<h1 id=\"紋理動畫\"><a href=\"#紋理動畫\" class=\"headerlink\" title=\"紋理動畫\"></a>紋理動畫</h1><p>在採樣紋理的時候，可以嘗試把紋理的圖片UV座標平移，達到產生複雜動畫的錯覺</p>\n</details>\n\n<h1 id=\"備忘\"><a href=\"#備忘\" class=\"headerlink\" title=\"備忘\"></a>備忘</h1><p><a href=\"https://www.adobe.com/products/substance3d-painter.html\">https://www.adobe.com/products/substance3d-painter.html</a></p>\n","feature":null,"text":"GQ002 模型格式和材質OBJ文件OBJ文件是一種被廣泛使用的3D模型文件格式（obj為後綴名）。由Alias|Wavefront公司為3D建模和動畫軟件”Advanced Visualizer”開發的一種標準，適合用於3D軟件模型之間的互導，也可以通過3dsmax、Maya等...","link":"","photos":[],"count_time":{"symbolsCount":"3.1k","symbolsTime":"3 mins."},"categories":[{"name":"遊戲開發筆記","slug":"遊戲開發筆記","count":15,"path":"api/categories/遊戲開發筆記.json"}],"tags":[{"name":"Computer Graphic","slug":"Computer-Graphic","count":15,"path":"api/tags/Computer-Graphic.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#GQ002-%E6%A8%A1%E5%9E%8B%E6%A0%BC%E5%BC%8F%E5%92%8C%E6%9D%90%E8%B3%AA\"><span class=\"toc-text\">GQ002 模型格式和材質</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#OBJ%E6%96%87%E4%BB%B6\"><span class=\"toc-text\">OBJ文件</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#OBJ%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F\"><span class=\"toc-text\">OBJ文件格式:</span></a></li></ol></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#FBX%E6%A0%BC%E5%BC%8F\"><span class=\"toc-text\">FBX格式</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E6%8F%90%E9%AB%98%E5%85%A7%E5%AE%B9\"><span class=\"toc-text\">提高內容:</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E6%9D%90%E8%B3%AA\"><span class=\"toc-text\">材質</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%8F%8D%E5%B0%84%E5%85%89\"><span class=\"toc-text\">反射光</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%8F%8D%E5%B0%84%E5%85%89%E9%A1%9E%E5%9E%8B\"><span class=\"toc-text\">反射光類型</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E9%A0%82%E9%BB%9E%E9%A1%8F%E8%89%B2%E5%B0%8F%E6%8A%80%E5%B7%A7\"><span class=\"toc-text\">頂點顏色小技巧</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%85%89%E6%BB%91%E7%B5%84\"><span class=\"toc-text\">光滑組</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%85%89%E6%BB%91%E7%B5%84%E5%92%8C%E6%B3%95%E7%B7%9A\"><span class=\"toc-text\">光滑組和法線</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E7%B4%8B%E7%90%86%E5%8B%95%E7%95%AB\"><span class=\"toc-text\">紋理動畫</span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E5%82%99%E5%BF%98\"><span class=\"toc-text\">備忘</span></a></li></ol>","author":{"name":"tom_ci","slug":"blog-author","avatar":"https://cdn.discordapp.com/attachments/894788659356794880/1052779378314059846/AOh14GhDhRBs5Io0sk5AfsOAZLWzpaTSlQQbTaye9fiGhQs432-p-rw-no.png","link":"/","description":"tom_ci，也可以叫我CI，tom，ic，湯姆希艾或者是湯姆，艾希，Macau SMP現任群主。","socials":{"github":"https://github.com/tom-choi","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"discord":{"icon":"/svg/discord.svg","link":"https://discord.gg/Ua2njAfQCN"}}}},"mapped":true,"prev_post":{"title":"COM架構","uid":"58cce547e2f24b99cce315d0703eb5c7","slug":"C++SideQuest/SQ004 COM架構","date":"2022-12-14T14:00:28.000Z","updated":"2022-12-14T14:49:04.209Z","comments":true,"path":"api/articles/C++SideQuest/SQ004 COM架構.json","keywords":null,"cover":"https://pbs.twimg.com/media/FiPw76eacAEl6g8.jpg","text":"COM架構COM架構，元件物件模型（英語：Component Object Model，縮寫COM） 其實可以當成是一個普通的c++類，只不過COM架構更加具體且擁有統一的定義 在學習Direct3D的時候經常可以看見以大寫字母“I”為前綴COM接口。例如，表示2D紋理的接口為I...","link":"","photos":[],"count_time":{"symbolsCount":228,"symbolsTime":"1 mins."},"categories":[{"name":"C/C++筆記","slug":"C-C-筆記","count":5,"path":"api/categories/C-C-筆記.json"}],"tags":[{"name":"C++","slug":"C","count":5,"path":"api/tags/C.json"}],"author":{"name":"tom_ci","slug":"blog-author","avatar":"https://cdn.discordapp.com/attachments/894788659356794880/1052779378314059846/AOh14GhDhRBs5Io0sk5AfsOAZLWzpaTSlQQbTaye9fiGhQs432-p-rw-no.png","link":"/","description":"tom_ci，也可以叫我CI，tom，ic，湯姆希艾或者是湯姆，艾希，Macau SMP現任群主。","socials":{"github":"https://github.com/tom-choi","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"discord":{"icon":"/svg/discord.svg","link":"https://discord.gg/Ua2njAfQCN"}}}},"feature":null},"next_post":{"title":"HLSL 入門和基本函數","uid":"364a4cad820c2b7aa61aea1e7f6bce5d","slug":"GraphicQuest/GQ003 HLSL入門和基本函數","date":"2022-12-14T14:00:28.000Z","updated":"2022-12-14T16:27:39.291Z","comments":true,"path":"api/articles/GraphicQuest/GQ003 HLSL入門和基本函數.json","keywords":null,"cover":"https://cdn.discordapp.com/attachments/1032335453988335676/1042702739274203168/20221105_194029.jpg","text":"HLSL 入門和基本函數什麼是HLSL？ 高階著色器語言（High Level Shader Language，簡稱HLSL），就是用來編寫shader的一種語言 類似的語言還有： CG它是由NVIDIA公司所開發的，基於C語言同時被OpenGL和Direct3D所支持的開發語言...","link":"","photos":[],"count_time":{"symbolsCount":"6.7k","symbolsTime":"6 mins."},"categories":[{"name":"遊戲開發筆記","slug":"遊戲開發筆記","count":15,"path":"api/categories/遊戲開發筆記.json"}],"tags":[{"name":"Computer Graphic","slug":"Computer-Graphic","count":15,"path":"api/tags/Computer-Graphic.json"}],"author":{"name":"tom_ci","slug":"blog-author","avatar":"https://cdn.discordapp.com/attachments/894788659356794880/1052779378314059846/AOh14GhDhRBs5Io0sk5AfsOAZLWzpaTSlQQbTaye9fiGhQs432-p-rw-no.png","link":"/","description":"tom_ci，也可以叫我CI，tom，ic，湯姆希艾或者是湯姆，艾希，Macau SMP現任群主。","socials":{"github":"https://github.com/tom-choi","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"discord":{"icon":"/svg/discord.svg","link":"https://discord.gg/Ua2njAfQCN"}}}},"feature":null}}